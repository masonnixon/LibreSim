{
  "id": "example-kalman-filter",
  "metadata": {
    "name": "Kalman Filter State Estimation",
    "description": "Demonstrates Kalman filter for estimating a ramp signal. The true state is a ramp with known dynamics (constant velocity), and the Kalman filter estimates the position from noisy measurements. Uses new State Observers block category.",
    "author": "LibreSim Examples",
    "createdAt": "2024-01-01T00:00:00Z",
    "modifiedAt": "2024-01-01T00:00:00Z",
    "version": "1.0.0"
  },
  "blocks": [
    {
      "id": "ramp1",
      "type": "ramp",
      "name": "True Signal",
      "position": { "x": 50, "y": 100 },
      "parameters": {
        "slope": 0.5,
        "startTime": 0,
        "initialOutput": 0
      },
      "inputPorts": [],
      "outputPorts": [
        { "id": "ramp1-out", "name": "out", "dataType": "double", "dimensions": [1] }
      ]
    },
    {
      "id": "const1",
      "type": "constant",
      "name": "Control (0)",
      "position": { "x": 50, "y": 250 },
      "parameters": {
        "value": 0
      },
      "inputPorts": [],
      "outputPorts": [
        { "id": "const1-out", "name": "out", "dataType": "double", "dimensions": [1] }
      ]
    },
    {
      "id": "kalman1",
      "type": "kalman_filter",
      "name": "Kalman Filter",
      "position": { "x": 350, "y": 175 },
      "parameters": {
        "A": [[1]],
        "B": [[0.01]],
        "C": [[1]],
        "Q": [[0.001]],
        "R": [[0.1]],
        "initialState": [0],
        "initialP": [[1]]
      },
      "inputPorts": [
        { "id": "kalman1-in1", "name": "u", "dataType": "double", "dimensions": [1] },
        { "id": "kalman1-in2", "name": "y", "dataType": "double", "dimensions": [1] }
      ],
      "outputPorts": [
        { "id": "kalman1-out", "name": "x_hat", "dataType": "double", "dimensions": [1] }
      ]
    },
    {
      "id": "scope1",
      "type": "scope",
      "name": "Comparison",
      "position": { "x": 550, "y": 150 },
      "parameters": {
        "numInputs": 2
      },
      "inputPorts": [
        { "id": "scope1-in1", "name": "in1", "dataType": "double", "dimensions": [1] },
        { "id": "scope1-in2", "name": "in2", "dataType": "double", "dimensions": [1] }
      ],
      "outputPorts": []
    }
  ],
  "connections": [
    {
      "id": "conn1",
      "sourceBlockId": "const1",
      "sourcePortId": "const1-out",
      "targetBlockId": "kalman1",
      "targetPortId": "kalman1-in1"
    },
    {
      "id": "conn2",
      "sourceBlockId": "ramp1",
      "sourcePortId": "ramp1-out",
      "targetBlockId": "kalman1",
      "targetPortId": "kalman1-in2"
    },
    {
      "id": "conn3",
      "sourceBlockId": "ramp1",
      "sourcePortId": "ramp1-out",
      "targetBlockId": "scope1",
      "targetPortId": "scope1-in1"
    },
    {
      "id": "conn4",
      "sourceBlockId": "kalman1",
      "sourcePortId": "kalman1-out",
      "targetBlockId": "scope1",
      "targetPortId": "scope1-in2"
    }
  ],
  "simulationConfig": {
    "solver": "rk4",
    "startTime": 0,
    "stopTime": 10,
    "stepSize": 0.01
  }
}
